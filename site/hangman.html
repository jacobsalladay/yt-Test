<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles.css">
    <title>Hangman</title>
</head>
<body>
    <nav>
        <div class="topnav">
            <a href="../index.html">Home</a>
            <a href="doc-structure-before.html" title="other page">HTML Entities</a>
            <a href="working-progress.html" title="A working document page">Scratch Work</a>
            <a class="active" href="hangman.html">Hangman</a>
            <a href="#">Contact</a>
            <a href="#">Mission Statement</a>
        </div>
    </nav>
    <div>
        <div id="livesRem">
            Lives Left: 7
        </div>
        
        <canvas id="hangman">
            Your browser does not support the canvas tag.
        </canvas>

        <div id="revWord">
            _ _ _ _
        </div>
    </div> 
    <div id="inPad">
        <p id="status"><b>Make a guess!</b></p>
        <div id="inRow1" class="inRows">
            <button class=inButton id=A  type="button">A</button>
            <button class=inButton id=B  type="button">B</button>
            <button class=inButton id=C  type="button">C</button>
            <button class=inButton id=D  type="button">D</button>
            <button class=inButton id=E  type="button">E</button>
            <button class=inButton id=F  type="button">F</button>
            <button class=inButton id=G  type="button">G</button>
        </div>
    
        <div id="inRow2" class="inRows">
            <button class=inButton id=H  type="button">H</button>
            <button class=inButton id=I  type="button">I</button>
            <button class=inButton id=J  type="button">J</button>
            <button class=inButton id=K  type="button">K</button>
            <button class=inButton id=L  type="button">L</button>
            <button class=inButton id=M  type="button">M</button>
            <button class=inButton id=N  type="button">N</button>
        </div>

        <div id="inRow3" class="inRows">
            <button class=inButton id=O  type="button">O</button>
            <button class=inButton id=P  type="button">P</button>
            <button class=inButton id=Q  type="button">Q</button>
            <button class=inButton id=R  type="button">R</button>
            <button class=inButton id=S  type="button">S</button>
            <button class=inButton id=T  type="button">T</button>
            <button class=inButton id=U  type="button">U</button>
        </div>

        <div id="inRow4" class="inRows">
            <button class=inButton id=V  type="button">V</button>
            <button class=inButton id=W  type="button">W</button>
            <button class=inButton id=X  type="button">X</button>
            <button class=inButton id=Y  type="button">Y</button>
            <button class=inButton id=Z type="button">Z</button>
            <button class=inButton id=# type="button">#</button>
        </div>
    </div>
    
    <script>
        let lives=7;
        let playAgain;
        let gameOver=false;
        const alpha=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
        let alphaGuessed=[]
        for(let i=0;i<alpha.length;i++){alphaGuessed.push(false)};
        const wordList=["testing","oNlY","these","WORDS!"];
        for(var i = 0; i <wordList.length;i++){
            wordList[i]=wordList[i].toUpperCase();
        }
        let guessedWord="";
        let hiddenWord=wordList[0]//randInt(0,wordList.length-1)];
        let shown="";
        let shownBool=[];
        const canvas = document.getElementById("hangman");
        const ctx = canvas.getContext("2d");
        ctx.fillStyle="black";
        ctx.fillRect(100, 100, 100, 5);
        ctx.fillRect(200,105,5,-100);
        ctx.fillRect(200,5,-50,5);
        ctx.fillRect(150,5,5,25);
        ctx.beginPath();
        ctx.arc(canvas.width/2+2.5,35,5,0,2*Math.PI);
        ctx.stroke();
        hideWord(hiddenWord);
        initWord();

        //Creating buttons for the display
        

        //Setting up all buttons to update the revealed word
        for(let i = 0; i < alpha.length;i++){
            let d = alpha[i];
            /* const newButton=document.createElement('button');
            newButton.id=d;
            newButton.textContent=d;
            newButton.className= 'inButton';
            if(i<7){let r = 1}
            else if(i<14){let r = 2}
            else if(i<21){let r=3}
            else{let r=4}
            document.getElementById("inRow"+r).appendChild(newButton);*/
            document.getElementById(d).addEventListener("click",function(){updateRevWord(d)});
        }

        function hideWord(hiddenWord){
            hiddenWord=hiddenWord.toUpperCase();
            console.log(hiddenWord);
            for(let i = 0; i < hiddenWord.length;i++){
                shownBool.push(false);
            }
            console.log(shownBool);
        }

        function initWord(){
            let temp="";
            for(let i = 0; i < shownBool.length;i++){
                temp=temp+"_ ";
            }
            shown=temp;
            console.log(temp);
            document.getElementById("revWord").innerHTML = temp;
        }
        function updateRevWord(inLetter){ //Checks letter to see if it's in the hidden word. Will then reveal each letter found.
            console.log("Searching for the letter " + inLetter);
            shown="";
            let index = alpha.indexOf(inLetter);
            console.log(index);
            console.log(alpha[index]+" is at index " + index + " and has " + (alphaGuessed[index] ? "":"not ") + "been guessed");
            if(gameOver || alphaGuessed[index]){
                console.log("Problem, ended loop")
                return;
            }
            alphaGuessed[index]=true;
            if(hiddenWord.includes(inLetter)==true){
                console.log("Instance Found!");
                for(let i = 0; i < hiddenWord.length;i++){
                if(hiddenWord[i]===inLetter.toUpperCase()){
                    shownBool[i]=true;
                   }
                }
            }
            else{
                lives--;
                document.getElementById("livesRem").innerHTML = "Lives Left: " + lives;
            }
            for(let i = 0; i < shownBool.length;i++){
                if(shownBool[i] ){
                    shown=shown+hiddenWord[i]+" ";
                }
                else{
                    shown=shown + "_ ";
                }
                
            }
            document.getElementById("revWord").innerHTML = shown;
            console.log(shown);
            checkWin();
        }
        //Returns a random integer between two values
        function randInt(min, max){
            return Math.floor(Math.random()*(max-min))+min;
        }

        function checkWin(){
            let win = true;
            for(let i = 0; i < hiddenWord.length;i++){
                if(shownBool[i]==false){
                    win=false;
                }
            }
            if(win){
                document.getElementById("status").innerHTML = "Congratulations!";
                gameOver=true;


            }
            else if(lives<=0){
                document.getElementById("status").innerHTML = "You Lose!";
                gameOver=true;
            }

            if(gameOver){
                let result= win ? "winner":"loser";
                playAgain=window.confirm("You were a "+result+". Play again?");
                if(playAgain){resetGame()}
                return;

            }
        }

        function resetGame(){
            lives=7;
            playAgain=false;
            gameOver=false;
            alphaGuessed=[]
            for(let i=0;i<alpha.length;i++){alphaGuessed.push(false)};
            guessedWord="";
            hiddenWord=wordList[0];
            shown="";
            shownBool=[];
            hideWord(hiddenWord);
            initWord();
            document.getElementById("livesRem").innerHTML = "Lives Left: " + lives;

        }

        function updateCanvas(){

        }
    </script>

</body>
</html>